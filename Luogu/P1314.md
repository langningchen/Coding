# P1314 [NOIP2011 提高组] 聪明的质监员
***您已经提交过此题但未通过！***

## 题目描述

`小T` 是一名质量监督员，最近负责检验一批矿产的质量。这批矿产共有 $n$ 个矿石，从 $1$ 到 $n$ 逐一编号，每个矿石都有自己的重量 $w_i$ 以及价值 $v_i$ 。检验矿产的流程是：

1 、给定$ m$ 个区间 $[l_i,r_i]$；

2 、选出一个参数 $W$；

3 、对于一个区间 $[l_i,r_i]$，计算矿石在这个区间上的检验值 $y_i$：

$$y_i=\sum\limits_{j=l_i}^{r_i}[w_j \ge W] \times \sum\limits_{j=l_i}^{r_i}[w_j \ge W]v_j$$  

其中 $j$ 为矿石编号。

这批矿产的检验结果 $y$ 为各个区间的检验值之和。即：$\sum\limits_{i=1}^m y_i$  

若这批矿产的检验结果与所给标准值 $s$ 相差太多，就需要再去检验另一批矿产。`小T` 不想费时间去检验另一批矿产，所以他想通过调整参数 $W$ 的值，让检验结果尽可能的靠近标准值 $s$，即使得 $|s-y|$ 最小。请你帮忙求出这个最小值。

## 输入格式

第一行包含三个整数 $n,m,s$，分别表示矿石的个数、区间的个数和标准值。

接下来的 $n$ 行，每行两个整数，中间用空格隔开，第 $i+1$ 行表示 $i$ 号矿石的重量 $w_i$ 和价值 $v_i$。

接下来的 $m$ 行，表示区间，每行两个整数，中间用空格隔开，第 $i+n+1$ 行表示区间 $[l_i,r_i]$ 的两个端点 $l_i$ 和 $r_i$。注意：不同区间可能重合或相互重叠。

## 输出格式

一个整数，表示所求的最小值。

## 输入输出样例

输入 #1
```
5 3 15 
1 5 
2 5 
3 5 
4 5 
5 5 
1 5 
2 4 
3 3
```
输出 #1
```
10
```

## 提示

【输入输出样例说明】

当 $W$ 选 $4$ 的时候，三个区间上检验值分别为 $20,5 ,0$ ，这批矿产的检验结果为 $25$，此时与标准值 $S$ 相差最小为 $10$。

【数据范围】

对于 $10\% $ 的数据，有 $1 ≤n ,m≤10$；

对于 $30\% $的数据，有 $1 ≤n ,m≤500$ ；

对于 $50\% $ 的数据，有 $ 1 ≤n ,m≤5,000$；
 
对于 $70\%$ 的数据，有 $1 ≤n ,m≤10,000$ ；

对于 $100\%$ 的数据，有 $ 1 ≤n ,m≤200,000$，$0 < w_i,v_i≤10^6$，$0 < s≤10^{12}$，$1 ≤l_i ≤r_i ≤n$ 。

## 时空限制
|测试点编号|时间限制|空间限制|
|:---:|:---:|:---:|
|$1$|$125MB$|$1s$|
|$2$|$125MB$|$1s$|
|$3$|$125MB$|$1s$|
|$4$|$125MB$|$1s$|
|$5$|$125MB$|$1s$|
|$6$|$125MB$|$1s$|
|$7$|$125MB$|$1s$|
|$8$|$125MB$|$1s$|
|$9$|$125MB$|$1s$|
|$10$|$125MB$|$1s$|
|$11$|$125MB$|$1s$|
|$12$|$125MB$|$1s$|
|$13$|$125MB$|$1s$|
|$14$|$125MB$|$1s$|
|$15$|$125MB$|$1s$|
|$16$|$125MB$|$1s$|
|$17$|$125MB$|$1s$|
|$18$|$125MB$|$1s$|
|$19$|$125MB$|$1s$|
|$20$|$125MB$|$1s$|

## 最后一次提交代码

```
#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
const int N = 200005;
int n, m, x, y, mid, l[N], r[N], w[N], v[N];
ll W, S, sum, sv[N], sw[N];
int main()
{
    cin >> n >> m >> S;
    W = S;
    for (int i = 1; i <= n; i++)
    {
        cin >> w[i] >> v[i];
        y = max(y, w[i]);
    }
    x = 1;
    y++;
    for (int i = 1; i <= m; i++)
        cin >> l[i] >> r[i];
    while (x < y)
    {
        memset(sv, 0, sizeof(sv));
        memset(sw, 0, sizeof(sw));
        mid = (x + y) >> 1;
        sum = 0;
        for (int i = 1; i <= n; i++)
            if (w[i] >= mid)
            {
                sw[i] = sw[i - 1] + 1;
                sv[i] = sv[i - 1] + v[i];
            }
            else
            {
                sw[i] = sw[i - 1];
                sv[i] = sv[i - 1];
            }
        for (int i = 1; i <= m; i++)
            sum += (ll)(sw[r[i]] - sw[l[i] - 1]) * (sv[r[i]] - sv[l[i]] - 1);
        if (sum == S)
        {
            W = 0;
            break;
        }
        W = min(W, abs(sum - S));
        if (sum <= S)
            y = mid;
        else if (sum > S)
            x = mid + 1;
    }
    cout << W << endl;
    return 0;
}
```

## 其他数据

|项目|值|
|:---:|:---:|
|难度|<span style="font-weight: bold; color: #52c41a">普及+/提高</span>|
|标签|<span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; border-radius: 2px; color: white; padding: 0px 8px; background-color: #2949b4; ">数学</span><span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; border-radius: 2px; color: white; padding: 0px 8px; background-color: #3498db; ">2011</span><span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; border-radius: 2px; color: white; padding: 0px 8px; background-color: #2949b4; ">二分</span><span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; border-radius: 2px; color: white; padding: 0px 8px; background-color: #13c2c2; ">NOIp 提高组</span><span style="display: inline-block; margin-right: 5px; margin-bottom: 5px; border-radius: 2px; color: white; padding: 0px 8px; background-color: #2949b4; ">前缀和</span>|
|提交人数|$60312$|
|通过人数|$15758$|
|通过率|$26.1275\%$|
|来源|`主题库`|
|最后一次提交语言|`自动识别语言`|

